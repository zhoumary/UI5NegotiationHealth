/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/documentation/sdk/controller/MasterTreeBaseController","sap/ui/documentation/sdk/controller/util/APIInfo","sap/ui/model/json/JSONModel"],function(M,A,J){"use strict";return M.extend("sap.ui.documentation.sdk.controller.TopicMaster",{onInit:function(){this.oJSONContent=this._fetchDocuIndex();var m=new J(this.oJSONContent);m.setSizeLimit(10000);this.getView().setModel(m);this._initTreeUtil("key","links");this.getRouter().getRoute("topic").attachPatternMatched(this._onMatched,this);this.getRouter().getRoute("topicId").attachPatternMatched(this._onTopicMatched,this);},_onTopicMatched:function(a){try{this.showMasterSide();}catch(e){jQuery.sap.log.error(e);}this._topicId=a.getParameter("arguments").id;this._expandTreeToNode(this._topicId,this.getModel());},_onMatched:function(){var s=this.getView().getParent().getParent();s.setMode(sap.m.SplitAppMode.ShowHideMode);this._collapseAllNodes();this._clearSelection();},_fetchDocuIndex:function(){var r=jQuery.sap.syncGetJSON(this.getConfig().docuPath+"index.json");if(r.data===undefined){return[];}var d=r.data.links;d=this._reorderDocuIndex(d);d=this._addSearchMetadata(d,"");return d;},_reorderDocuIndex:function(d){var m="95d113be50ae40d5b0b562b84d715227",t="1b4124400a764ec0a8623d0d5c585321",p=[],T,o;for(var i=0;i<d.length;i++){if(d[i].key===m){o=d[i];}else if(d[i].key===t){T=d[i];}}if(o){p=o.links;if(T){p.push(T);}}return p;},_addSearchMetadata:function(d,p){for(var i=0;i<d.length;i++){d[i].name=p?p+" "+d[i].text:d[i].text;if(d[i].links){d[i].links=this._addSearchMetadata(d[i].links,d[i].text);}}return d;},onNodeSelect:function(e){var n=e.getParameter("listItem"),t=n.getCustomData()[0].getValue(),r;if(!t){jQuery.sap.log.warning("Missing key for entity: "+n.getId()+" - cannot navigate to topic");return;}r=this.getRouter();if(t==="a6a78b7e104348b4bb94fb8bcf003480"){r.navTo("releaseNotes");return;}r.navTo("topicId",{id:t},false);}});});
